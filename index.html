<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Inventory Manager</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
  <style>
    .hover\:scale-105:hover{transform:scale(1.05)}
    .transition-transform{transition:transform .2s}
    .transition-all{transition:all .2s}
    .transition-opacity{transition:opacity .2s}
    .transition-colors{transition:color .2s}
    .group:hover .group-hover\:opacity-100{opacity:1}
    .group-hover\:opacity-100{opacity:0}
    .group:hover .group-hover\:text-indigo-400{color:#818cf8}
    .group:hover .group-hover\:text-green-500{color:#22c55e}
    .group:hover .group-hover\:border-indigo-300{border-color:#a5b4fc}
    .group:hover .group-hover\:shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1)}
    .group:hover .group-hover\:shadow-xl{box-shadow:0 20px 25px -5px rgba(0,0,0,.1)}
    .group:hover .group-hover\:border-green-400{border-color:#4ade80}
    .animate-fade{animation:fade .15s ease-in}
    @keyframes fade{from{opacity:0;transform:translateY(-4px)}to{opacity:1;transform:translateY(0)}}
  </style>
</head>
<body class="bg-gray-50 m-0 p-0">
<div id="root"></div>
<script type="text/babel" data-presets="react">
const { useState, useEffect } = React;
const STORAGE_KEY = "visual_inventory_v2";
const uid = () => Math.random().toString(36).slice(2,9);
const COLORS = [
  ["#3b82f6","#2563eb"],["#8b5cf6","#7c3aed"],["#10b981","#059669"],
  ["#f97316","#ea580c"],["#ec4899","#db2777"],["#14b8a6","#0d9488"],
  ["#ef4444","#dc2626"],["#6366f1","#4f46e5"],["#eab308","#ca8a04"],["#06b6d4","#0891b2"]
];

function Modal({title,onClose,children}){
  return React.createElement('div',{style:{position:'fixed',inset:0,zIndex:50,display:'flex',alignItems:'center',justifyContent:'center',padding:16,background:'rgba(0,0,0,0.6)'}},
    React.createElement('div',{style:{background:'#fff',borderRadius:16,boxShadow:'0 25px 50px rgba(0,0,0,0.25)',width:'100%',maxWidth:440}},
      React.createElement('div',{style:{display:'flex',alignItems:'center',justifyContent:'space-between',padding:'16px 20px',borderBottom:'1px solid #e5e7eb'}},
        React.createElement('h2',{style:{fontWeight:700,fontSize:17,margin:0}},title),
        React.createElement('button',{onClick:onClose,style:{border:'none',background:'none',cursor:'pointer',fontSize:20,color:'#6b7280',padding:'0 4px'}},'Ã—')
      ),
      React.createElement('div',{style:{padding:20}},children)
    )
  );
}

function Input({label,value,onChange,type='text',placeholder,rows}){
  const style={width:'100%',border:'1.5px solid #e5e7eb',borderRadius:10,padding:'8px 12px',fontSize:14,outline:'none',boxSizing:'border-box',fontFamily:'inherit'};
  return React.createElement('div',{style:{marginBottom:12}},
    React.createElement('label',{style:{display:'block',fontSize:13,fontWeight:600,color:'#374151',marginBottom:4}},label),
    rows
      ? React.createElement('textarea',{value,onChange,placeholder,rows,style:{...style,resize:'none'}})
      : React.createElement('input',{type,value,onChange,placeholder,style})
  );
}

function SimpleForm({label,initial='',onSave,onClose,extraFields=[],extraInit={}}){
  const [name,setName]=useState(initial);
  const [ext,setExt]=useState(extraInit);
  const btn={background:name.trim()?'#4f46e5':'#c7d2fe',color:'#fff',border:'none',borderRadius:10,padding:'9px 0',fontSize:14,fontWeight:600,cursor:name.trim()?'pointer':'default',flex:1};
  return React.createElement('div',null,
    React.createElement(Input,{label:`${label} Name *`,value:name,onChange:e=>setName(e.target.value),placeholder:`Enter ${label.toLowerCase()} name`}),
    extraFields.map(f=>React.createElement(Input,{key:f.key,label:f.label,value:ext[f.key]??'',onChange:e=>setExt(p=>({...p,[f.key]:e.target.value})),type:f.type||'text',placeholder:f.placeholder,rows:f.rows})),
    React.createElement('div',{style:{display:'flex',gap:8,marginTop:4}},
      React.createElement('button',{onClick:onClose,style:{flex:1,border:'1.5px solid #e5e7eb',borderRadius:10,padding:'9px 0',fontSize:14,fontWeight:600,background:'#fff',cursor:'pointer'}},'Cancel'),
      React.createElement('button',{onClick:()=>name.trim()&&onSave(name.trim(),ext),style:btn},'âœ“ Save')
    )
  );
}

function Crumb({crumbs,onNav}){
  return React.createElement('div',{style:{display:'flex',alignItems:'center',gap:4,flexWrap:'wrap',fontSize:14}},
    crumbs.map((c,i)=>React.createElement('span',{key:i,style:{display:'flex',alignItems:'center',gap:4}},
      i>0&&React.createElement('span',{style:{color:'#d1d5db'}},'â€º'),
      React.createElement('button',{onClick:()=>onNav(i),style:{border:'none',background:'none',cursor:'pointer',fontWeight:i===crumbs.length-1?700:400,color:i===crumbs.length-1?'#111827':'#6b7280',padding:0,fontSize:14}},c)
    ))
  );
}

function LocationCard({loc,onSelect,onEdit,onDelete}){
  const [hover,setHover]=useState(false);
  const total=(loc.rooms||[]).flatMap(r=>(r.shelves||[]).flatMap(s=>(s.layers||[]).flatMap(l=>l.items||[]))).length;
  return React.createElement('div',{
    onClick:()=>onSelect(loc),onMouseEnter:()=>setHover(true),onMouseLeave:()=>setHover(false),
    style:{background:'#fff',borderRadius:16,border:`2px solid ${hover?'#a5b4fc':'#f3f4f6'}`,boxShadow:hover?'0 10px 25px rgba(0,0,0,0.1)':'0 1px 3px rgba(0,0,0,0.05)',cursor:'pointer',overflow:'hidden',position:'relative',transition:'all .2s'}
  },
    React.createElement('div',{style:{height:6,background:'linear-gradient(to right,#6366f1,#a855f7)'}}),
    React.createElement('div',{style:{padding:20}},
      React.createElement('div',{style:{display:'flex',alignItems:'flex-start',justifyContent:'space-between'}},
        React.createElement('div',{style:{display:'flex',alignItems:'center',gap:12}},
          React.createElement('div',{style:{width:40,height:40,borderRadius:12,background:'#eef2ff',display:'flex',alignItems:'center',justifyContent:'center',fontSize:20}},'ðŸ¢'),
          React.createElement('div',null,
            React.createElement('div',{style:{fontWeight:700,fontSize:16,color:'#111827'}},loc.name),
            React.createElement('div',{style:{fontSize:12,color:'#9ca3af',marginTop:2}},`${(loc.rooms||[]).length} rooms Â· ${total} items`)
          )
        ),
        React.createElement('span',{style:{color:hover?'#818cf8':'#d1d5db',fontSize:18}},'â€º')
      ),
      React.createElement('div',{style:{display:'flex',gap:4,marginTop:14}},
        (loc.rooms||[]).length===0
          ? React.createElement('div',{style:{height:6,flex:1,borderRadius:99,background:'#f3f4f6'}})
          : (loc.rooms||[]).slice(0,6).map((r,i)=>React.createElement('div',{key:r.id,style:{height:6,flex:1,borderRadius:99,background:`linear-gradient(to right,${COLORS[i%COLORS.length][0]},${COLORS[i%COLORS.length][1]})`,opacity:.65}}))
      )
    ),
    hover&&React.createElement('div',{style:{position:'absolute',top:10,right:10,display:'flex',gap:4},onClick:e=>e.stopPropagation()},
      React.createElement('button',{onClick:()=>onEdit(loc),style:{border:'1px solid #e5e7eb',background:'#fff',borderRadius:8,padding:'4px 7px',cursor:'pointer',fontSize:13}},'âœï¸'),
      React.createElement('button',{onClick:()=>onDelete(loc.id),style:{border:'1px solid #fee2e2',background:'#fff',borderRadius:8,padding:'4px 7px',cursor:'pointer',fontSize:13,color:'#ef4444'}},'ðŸ—‘')
    )
  );
}

function BuildingView({loc,onRoom,onAddRoom,onEditRoom,onDelRoom}){
  const rooms=loc.rooms||[];
  return React.createElement('div',null,
    React.createElement('div',{style:{display:'flex',alignItems:'center',justifyContent:'space-between',marginBottom:24}},
      React.createElement('div',null,
        React.createElement('h2',{style:{fontSize:24,fontWeight:800,margin:0}},loc.name),
        React.createElement('p',{style:{fontSize:13,color:'#9ca3af',margin:'4px 0 0'}},`${rooms.length} rooms â€” click a room to manage shelves`)
      ),
      React.createElement('button',{onClick:onAddRoom,style:{display:'flex',alignItems:'center',gap:6,background:'#4f46e5',color:'#fff',border:'none',borderRadius:12,padding:'9px 16px',fontSize:14,fontWeight:600,cursor:'pointer'}},'+ Add Room')
    ),
    React.createElement('div',{style:{background:'#f3f4f6',borderRadius:24,padding:24,border:'4px solid #e5e7eb',minHeight:280}},
      React.createElement('div',{style:{display:'flex',alignItems:'center',gap:8,marginBottom:16}},
        React.createElement('div',{style:{height:1,flex:1,background:'#d1d5db'}}),
        React.createElement('span',{style:{fontSize:12,color:'#9ca3af',fontWeight:600,padding:'0 8px'}},'ðŸ¢ FLOOR PLAN'),
        React.createElement('div',{style:{height:1,flex:1,background:'#d1d5db'}})
      ),
      rooms.length===0
        ? React.createElement('div',{style:{textAlign:'center',padding:'60px 0',color:'#9ca3af'}},
            React.createElement('div',{style:{fontSize:48,marginBottom:8}},'ðŸšª'),
            React.createElement('p',{style:{margin:0,fontWeight:600}},'No rooms yet'),
            React.createElement('p',{style:{margin:'4px 0 0',fontSize:13}},'Click "Add Room" to get started')
          )
        : React.createElement('div',{style:{display:'grid',gridTemplateColumns:'repeat(auto-fill,minmax(160px,1fr))',gap:12}},
            rooms.map((room,i)=>{
              const itemCount=(room.shelves||[]).flatMap(s=>(s.layers||[]).flatMap(l=>l.items||[])).length;
              const [c1,c2]=COLORS[i%COLORS.length];
              const [hov,setHov]=useState(false);
              return React.createElement('div',{key:room.id,onClick:()=>onRoom(room),onMouseEnter:()=>setHov(true),onMouseLeave:()=>setHov(false),
                style:{borderRadius:16,overflow:'hidden',cursor:'pointer',transform:hov?'scale(1.04)':'scale(1)',transition:'transform .15s',boxShadow:hov?'0 12px 24px rgba(0,0,0,0.15)':'0 2px 8px rgba(0,0,0,0.1)',position:'relative'}},
                React.createElement('div',{style:{background:`linear-gradient(135deg,${c1},${c2})`,padding:16,minHeight:110,display:'flex',flexDirection:'column',justifyContent:'space-between',position:'relative'}},
                  React.createElement('div',{style:{display:'flex',justifyContent:'space-between',alignItems:'flex-start'}},
                    React.createElement('span',{style:{fontSize:10,color:'rgba(255,255,255,0.75)',fontWeight:600,textTransform:'uppercase',letterSpacing:1}},'Room'),
                    hov&&React.createElement('div',{style:{display:'flex',gap:3},onClick:e=>e.stopPropagation()},
                      React.createElement('button',{onClick:()=>onEditRoom(room),style:{border:'none',background:'rgba(255,255,255,0.25)',borderRadius:6,padding:'2px 5px',cursor:'pointer',fontSize:11,color:'#fff'}},'âœï¸'),
                      React.createElement('button',{onClick:()=>onDelRoom(room.id),style:{border:'none',background:'rgba(255,255,255,0.25)',borderRadius:6,padding:'2px 5px',cursor:'pointer',fontSize:11,color:'#fff'}},'ðŸ—‘')
                    )
                  ),
                  React.createElement('div',null,
                    React.createElement('div',{style:{color:'#fff',fontWeight:700,fontSize:15,lineHeight:1.2}},room.name),
                    React.createElement('div',{style:{color:'rgba(255,255,255,0.7)',fontSize:12,marginTop:2}},`${(room.shelves||[]).length} shelves Â· ${itemCount} items`)
                  ),
                  React.createElement('div',{style:{position:'absolute',bottom:0,left:'50%',transform:'translateX(-50%)',width:22,height:30,background:'rgba(255,255,255,0.2)',borderRadius:'8px 8px 0 0',border:'2px solid rgba(255,255,255,0.3)'}})
                )
              );
            }),
            React.createElement('button',{onClick:onAddRoom,style:{borderRadius:16,border:'2px dashed #d1d5db',minHeight:110,display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',gap:6,color:'#9ca3af',background:'transparent',cursor:'pointer',fontSize:14,fontWeight:600}},
              React.createElement('span',{style:{fontSize:22}},'+'),
              'Add Room'
            )
          )
    )
  );
}

function RoomView({room,onShelf,onAddShelf,onEditShelf,onDelShelf}){
  const shelves=room.shelves||[];
  return React.createElement('div',null,
    React.createElement('div',{style:{display:'flex',alignItems:'center',justifyContent:'space-between',marginBottom:24}},
      React.createElement('div',null,
        React.createElement('h2',{style:{fontSize:24,fontWeight:800,margin:0}},room.name),
        React.createElement('p',{style:{fontSize:13,color:'#9ca3af',margin:'4px 0 0'}},`${shelves.length} shelves`)
      ),
      React.createElement('button',{onClick:onAddShelf,style:{display:'flex',alignItems:'center',gap:6,background:'#059669',color:'#fff',border:'none',borderRadius:12,padding:'9px 16px',fontSize:14,fontWeight:600,cursor:'pointer'}},'+ Add Shelf')
    ),
    React.createElement('div',{style:{background:'#fffbeb',borderRadius:24,padding:24,border:'4px solid #fde68a'}},
      React.createElement('div',{style:{display:'flex',alignItems:'center',gap:8,marginBottom:16}},
        React.createElement('div',{style:{height:1,flex:1,background:'#fcd34d'}}),
        React.createElement('span',{style:{fontSize:12,color:'#92400e',fontWeight:600,padding:'0 8px'}},'ðŸ—„ï¸ SHELF UNIT'),
        React.createElement('div',{style:{height:1,flex:1,background:'#fcd34d'}})
      ),
      shelves.length===0
        ? React.createElement('div',{style:{textAlign:'center',padding:'60px 0',color:'#b45309'}},
            React.createElement('div',{style:{fontSize:48,marginBottom:8}},'ðŸ“¦'),
            React.createElement('p',{style:{margin:0,fontWeight:600}},'No shelves yet')
          )
        : React.createElement('div',{style:{display:'flex',flexDirection:'column',gap:8}},
            shelves.map((shelf,i)=>{
              const itemCount=(shelf.layers||[]).flatMap(l=>l.items||[]).length;
              const [hov,setHov]=useState(false);
              return React.createElement('div',{key:shelf.id,onClick:()=>onShelf(shelf),onMouseEnter:()=>setHov(true),onMouseLeave:()=>setHov(false),
                style:{background:'#fff',borderRadius:12,border:`2px solid ${hov?'#4ade80':'#fde68a'}`,padding:'12px 16px',cursor:'pointer',display:'flex',alignItems:'center',gap:12,boxShadow:hov?'0 4px 12px rgba(0,0,0,0.08)':'none',transition:'all .15s'}},
                React.createElement('div',{style:{width:28,height:28,borderRadius:8,background:'#fef3c7',color:'#b45309',fontSize:12,fontWeight:700,display:'flex',alignItems:'center',justifyContent:'center'}},i+1),
                React.createElement('div',{style:{flex:1}},
                  React.createElement('div',{style:{fontWeight:600,color:'#111827'}},shelf.name),
                  React.createElement('div',{style:{fontSize:12,color:'#9ca3af'}},`${(shelf.layers||[]).length} layers Â· ${itemCount} items`)
                ),
                hov&&React.createElement('div',{style:{display:'flex',gap:4},onClick:e=>e.stopPropagation()},
                  React.createElement('button',{onClick:()=>onEditShelf(shelf),style:{border:'1px solid #e5e7eb',background:'#fff',borderRadius:7,padding:'3px 7px',cursor:'pointer',fontSize:12}},'âœï¸'),
                  React.createElement('button',{onClick:()=>onDelShelf(shelf.id),style:{border:'1px solid #fee2e2',background:'#fff',borderRadius:7,padding:'3px 7px',cursor:'pointer',fontSize:12,color:'#ef4444'}},'ðŸ—‘')
                ),
                React.createElement('span',{style:{color:hov?'#22c55e':'#d1d5db',fontSize:18}},'â€º')
              );
            })
          ),
      React.createElement('div',{style:{height:12,background:'#fcd34d',borderRadius:8,marginTop:12}})
    )
  );
}

function ShelfView({shelf,onUpdate}){
  const [layers,setLayers]=useState(shelf.layers||[]);
  const [modal,setModal]=useState(null);
  useEffect(()=>onUpdate({...shelf,layers}),[layers]);
  const addLayer=name=>{setLayers(p=>[...p,{id:uid(),name,items:[]}]);setModal(null);};
  const editLayer=(id,name)=>{setLayers(p=>p.map(l=>l.id===id?{...l,name}:l));setModal(null);};
  const delLayer=id=>{if(confirm('Delete layer?'))setLayers(p=>p.filter(l=>l.id!==id));};
  const addItem=(lid,name,ext)=>{setLayers(p=>p.map(l=>l.id===lid?{...l,items:[...l.items,{id:uid(),name,quantity:Number(ext.quantity)||0,notes:ext.notes||''}]}:l));setModal(null);};
  const editItem=(lid,item,name,ext)=>{setLayers(p=>p.map(l=>l.id===lid?{...l,items:l.items.map(i=>i.id===item.id?{...i,name,quantity:Number(ext.quantity)||0,notes:ext.notes||''}:i)}:l));setModal(null);};
  const delItem=(lid,iid)=>setLayers(p=>p.map(l=>l.id===lid?{...l,items:l.items.filter(i=>i.id!==iid)}:l));
  return React.createElement('div',null,
    React.createElement('div',{style:{display:'flex',alignItems:'center',justifyContent:'space-between',marginBottom:24}},
      React.createElement('div',null,
        React.createElement('h2',{style:{fontSize:24,fontWeight:800,margin:0}},shelf.name),
        React.createElement('p',{style:{fontSize:13,color:'#9ca3af',margin:'4px 0 0'}},`${layers.length} layers`)
      ),
      React.createElement('button',{onClick:()=>setModal({t:'addLayer'}),style:{background:'#ea580c',color:'#fff',border:'none',borderRadius:12,padding:'9px 16px',fontSize:14,fontWeight:600,cursor:'pointer'}},'+ Add Layer')
    ),
    layers.length===0&&React.createElement('div',{style:{textAlign:'center',padding:'60px 0',color:'#9ca3af'}},
      React.createElement('div',{style:{fontSize:48,marginBottom:8}},'ðŸ—‚ï¸'),
      React.createElement('p',{style:{margin:0}},'No layers yet')
    ),
    React.createElement('div',{style:{display:'flex',flexDirection:'column',gap:12}},
      layers.map((layer,i)=>React.createElement('div',{key:layer.id,style:{background:'#fff',borderRadius:16,border:'2px solid #fed7aa',overflow:'hidden',boxShadow:'0 1px 4px rgba(0,0,0,0.04)'}},
        React.createElement('div',{style:{display:'flex',alignItems:'center',gap:10,padding:'10px 14px',background:'linear-gradient(to right,#fff7ed,#fffbeb)',borderBottom:'1px solid #fed7aa'}},
          React.createElement('div',{style:{width:26,height:26,borderRadius:8,background:'#ea580c',color:'#fff',fontSize:12,fontWeight:700,display:'flex',alignItems:'center',justifyContent:'center'}},i+1),
          React.createElement('span',{style:{fontWeight:600,color:'#111827',flex:1}},layer.name),
          React.createElement('span',{style:{fontSize:12,color:'#9ca3af'}},`${layer.items.length} items`),
          React.createElement('button',{onClick:()=>setModal({t:'addItem',lid:layer.id}),style:{border:'none',background:'#fed7aa',borderRadius:7,padding:'4px 8px',cursor:'pointer',fontSize:12,fontWeight:600,color:'#c2410c'}},'+'),
          React.createElement('button',{onClick:()=>setModal({t:'editLayer',layer}),style:{border:'none',background:'#f3f4f6',borderRadius:7,padding:'4px 8px',cursor:'pointer',fontSize:12}},'âœï¸'),
          React.createElement('button',{onClick:()=>delLayer(layer.id),style:{border:'none',background:'#fee2e2',borderRadius:7,padding:'4px 8px',cursor:'pointer',fontSize:12,color:'#ef4444'}},'ðŸ—‘')
        ),
        React.createElement('div',{style:{padding:10}},
          layer.items.length===0
            ? React.createElement('button',{onClick:()=>setModal({t:'addItem',lid:layer.id}),style:{width:'100%',border:'2px dashed #e5e7eb',borderRadius:10,padding:'14px 0',color:'#9ca3af',background:'transparent',cursor:'pointer',fontSize:13}},
                '+ Add first item'
              )
            : React.createElement('div',{style:{display:'grid',gridTemplateColumns:'repeat(auto-fill,minmax(180px,1fr))',gap:8}},
                layer.items.map(item=>{
                  const [hov,setHov]=useState(false);
                  return React.createElement('div',{key:item.id,onMouseEnter:()=>setHov(true),onMouseLeave:()=>setHov(false),
                    style:{background:'#f9fafb',borderRadius:10,border:'1px solid #f3f4f6',padding:'8px 10px',display:'flex',gap:8,alignItems:'flex-start',position:'relative'}},
                    React.createElement('span',{style:{fontSize:16,marginTop:1}},'ðŸ“¦'),
                    React.createElement('div',{style:{flex:1,minWidth:0}},
                      React.createElement('div',{style:{fontWeight:600,fontSize:13,color:'#111827',overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap'}},item.name),
                      React.createElement('div',{style:{fontSize:12,color:'#6b7280'}},`Qty: ${item.quantity}${item.notes?` Â· ${item.notes}`:''}`)
                    ),
                    hov&&React.createElement('div',{style:{display:'flex',gap:2,flexShrink:0}},
                      React.createElement('button',{onClick:()=>setModal({t:'editItem',lid:layer.id,item}),style:{border:'none',background:'#e5e7eb',borderRadius:5,padding:'2px 5px',cursor:'pointer',fontSize:11}},'âœï¸'),
                      React.createElement('button',{onClick:()=>delItem(layer.id,item.id),style:{border:'none',background:'#fee2e2',borderRadius:5,padding:'2px 5px',cursor:'pointer',fontSize:11,color:'#ef4444'}},'ðŸ—‘')
                    )
                  );
                })
              )
        )
      ))
    ),
    modal?.t==='addLayer'&&React.createElement(Modal,{title:'Add Layer',onClose:()=>setModal(null)},React.createElement(SimpleForm,{label:'Layer',onSave:n=>addLayer(n),onClose:()=>setModal(null)})),
    modal?.t==='editLayer'&&React.createElement(Modal,{title:'Edit Layer',onClose:()=>setModal(null)},React.createElement(SimpleForm,{label:'Layer',initial:modal.layer.name,onSave:n=>editLayer(modal.layer.id,n),onClose:()=>setModal(null)})),
    modal?.t==='addItem'&&React.createElement(Modal,{title:'Add Item',onClose:()=>setModal(null)},React.createElement(SimpleForm,{label:'Item',onSave:(n,e)=>addItem(modal.lid,n,e),onClose:()=>setModal(null),extraFields:[{key:'quantity',label:'Quantity',type:'number',placeholder:'0'},{key:'notes',label:'Notes',rows:2,placeholder:'Optional notes'}]})),
    modal?.t==='editItem'&&React.createElement(Modal,{title:'Edit Item',onClose:()=>setModal(null)},React.createElement(SimpleForm,{label:'Item',initial:modal.item.name,onSave:(n,e)=>editItem(modal.lid,modal.item,n,e),onClose:()=>setModal(null),extraInit:{quantity:modal.item.quantity,notes:modal.item.notes},extraFields:[{key:'quantity',label:'Quantity',type:'number',placeholder:'0'},{key:'notes',label:'Notes',rows:2,placeholder:'Optional notes'}]}))
  );
}

function App(){
  const [data,setData]=useState(()=>{try{return JSON.parse(localStorage.getItem(STORAGE_KEY))||{locations:[]};}catch{return{locations:[]}}});
  const [nav,setNav]=useState([]);
  const [modal,setModal]=useState(null);
  const [search,setSearch]=useState('');
  useEffect(()=>localStorage.setItem(STORAGE_KEY,JSON.stringify(data)),[data]);
  const mutate=fn=>setData(p=>{const d=JSON.parse(JSON.stringify(p));fn(d);return d;});
  const curLoc=nav[0]?data.locations.find(l=>l.id===nav[0]):null;
  const curRoom=nav[1]?curLoc?.rooms?.find(r=>r.id===nav[1]):null;
  const curShelf=nav[2]?curRoom?.shelves?.find(s=>s.id===nav[2]):null;
  const crumbs=['ðŸ“¦ Locations',...(curLoc?[curLoc.name]:[]),...(curRoom?[curRoom.name]:[]),...(curShelf?[curShelf.name]:[])];
  const addLoc=n=>{mutate(d=>d.locations.push({id:uid(),name:n,rooms:[]}));setModal(null);};
  const editLoc=(id,n)=>{mutate(d=>{const l=d.locations.find(x=>x.id===id);if(l)l.name=n;});setModal(null);};
  const delLoc=id=>{if(!confirm('Delete location?'))return;mutate(d=>{d.locations=d.locations.filter(x=>x.id!==id);});};
  const addRoom=n=>{mutate(d=>d.locations.find(x=>x.id===curLoc.id).rooms.push({id:uid(),name:n,shelves:[]}));setModal(null);};
  const editRoom=(id,n)=>{mutate(d=>{const r=d.locations.find(x=>x.id===curLoc.id).rooms.find(x=>x.id===id);if(r)r.name=n;});setModal(null);};
  const delRoom=id=>{if(!confirm('Delete room?'))return;mutate(d=>{const l=d.locations.find(x=>x.id===curLoc.id);l.rooms=l.rooms.filter(x=>x.id!==id);});};
  const addShelf=n=>{mutate(d=>d.locations.find(x=>x.id===curLoc.id).rooms.find(x=>x.id===curRoom.id).shelves.push({id:uid(),name:n,layers:[]}));setModal(null);};
  const editShelf=(id,n)=>{mutate(d=>{const s=d.locations.find(x=>x.id===curLoc.id).rooms.find(x=>x.id===curRoom.id).shelves.find(x=>x.id===id);if(s)s.name=n;});setModal(null);};
  const delShelf=id=>{if(!confirm('Delete shelf?'))return;mutate(d=>{const r=d.locations.find(x=>x.id===curLoc.id).rooms.find(x=>x.id===curRoom.id);r.shelves=r.shelves.filter(x=>x.id!==id);});};
  const updateShelf=s=>mutate(d=>{const r=d.locations.find(x=>x.id===curLoc.id).rooms.find(x=>x.id===curRoom.id);const i=r.shelves.findIndex(x=>x.id===s.id);if(i>-1)r.shelves[i]=s;});
  const exportCSV=()=>{
    const rows=[['Location','Room','Shelf','Layer','Item','Quantity','Notes']];
    for(const l of data.locations)for(const r of l.rooms||[])for(const s of r.shelves||[])for(const ly of s.layers||[])for(const it of ly.items||[])
      rows.push([l.name,r.name,s.name,ly.name,it.name,it.quantity,it.notes||'']);
    const csv=rows.map(r=>r.map(v=>`"${String(v).replace(/"/g,'""')}"`).join(',')).join('\n');
    const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([csv],{type:'text/csv'}));a.download='inventory.csv';a.click();
  };
  const searchRes=search.trim()?()=>{
    const q=search.toLowerCase(),res=[];
    for(const l of data.locations)for(const r of l.rooms||[])for(const s of r.shelves||[])for(const ly of s.layers||[])for(const it of ly.items||[])
      if(it.name.toLowerCase().includes(q)||(it.notes||'').toLowerCase().includes(q))res.push({loc:l.name,room:r.name,shelf:s.name,layer:ly.name,item:it});
    return res;
  }():null;

  return React.createElement('div',{style:{minHeight:'100vh',background:'#f9fafb'}},
    // Header
    React.createElement('div',{style:{background:'#fff',borderBottom:'1px solid #e5e7eb',position:'sticky',top:0,zIndex:40,boxShadow:'0 1px 4px rgba(0,0,0,0.06)'}},
      React.createElement('div',{style:{maxWidth:900,margin:'0 auto',padding:'10px 16px',display:'flex',alignItems:'center',gap:10}},
        nav.length>0&&React.createElement('button',{onClick:()=>setNav(p=>p.slice(0,-1)),style:{border:'none',background:'#f3f4f6',borderRadius:10,padding:'7px 10px',cursor:'pointer',fontSize:16}},'â†'),
        React.createElement('div',{style:{flex:1}},React.createElement(Crumb,{crumbs,onNav:i=>setNav(nav.slice(0,i))})),
        React.createElement('div',{style:{position:'relative'}},
          React.createElement('span',{style:{position:'absolute',left:9,top:'50%',transform:'translateY(-50%)',color:'#9ca3af',fontSize:14}},'ðŸ”'),
          React.createElement('input',{placeholder:'Search items...',value:search,onChange:e=>setSearch(e.target.value),style:{paddingLeft:28,paddingRight:10,paddingTop:7,paddingBottom:7,border:'1.5px solid #e5e7eb',borderRadius:10,fontSize:13,outline:'none',width:160}})
        ),
        React.createElement('button',{onClick:exportCSV,title:'Export CSV',style:{border:'1.5px solid #e5e7eb',background:'#fff',borderRadius:10,padding:'7px 10px',cursor:'pointer',fontSize:14}},'â¬‡ï¸'),
      )
    ),
    React.createElement('div',{style:{maxWidth:900,margin:'0 auto',padding:'24px 16px'}},
      // Search results
      searchRes&&React.createElement('div',null,
        React.createElement('h3',{style:{fontWeight:700,marginBottom:12}},`Results for "${search}" (${searchRes.length})`),
        searchRes.length===0?React.createElement('p',{style:{color:'#9ca3af'}},'No items found.'):
        React.createElement('div',{style:{display:'grid',gridTemplateColumns:'repeat(auto-fill,minmax(240px,1fr))',gap:8}},
          searchRes.map((r,i)=>React.createElement('div',{key:i,style:{background:'#fff',borderRadius:12,border:'1px solid #e5e7eb',padding:'10px 14px',display:'flex',gap:10}},
            React.createElement('span',{style:{fontSize:20}},'ðŸ“¦'),
            React.createElement('div',null,
              React.createElement('div',{style:{fontWeight:600,fontSize:14}},`${r.item.name} Ã—${r.item.quantity}`),
              React.createElement('div',{style:{fontSize:12,color:'#9ca3af'}},`${r.loc} â€º ${r.room} â€º ${r.shelf} â€º ${r.layer}`),
              r.item.notes&&React.createElement('div',{style:{fontSize:12,color:'#9ca3af',fontStyle:'italic'}},r.item.notes)
            )
          ))
        )
      ),
      // Locations
      !searchRes&&nav.length===0&&React.createElement('div',null,
        React.createElement('div',{style:{display:'flex',alignItems:'center',justifyContent:'space-between',marginBottom:20}},
          React.createElement('h1',{style:{fontSize:24,fontWeight:800,margin:0}},'Locations'),
          React.createElement('button',{onClick:()=>setModal({t:'addLoc'}),style:{background:'#4f46e5',color:'#fff',border:'none',borderRadius:12,padding:'9px 16px',fontSize:14,fontWeight:600,cursor:'pointer'}},'+ Add Location')
        ),
        data.locations.length===0?React.createElement('div',{style:{textAlign:'center',padding:'80px 0',color:'#9ca3af'}},
          React.createElement('div',{style:{fontSize:64,marginBottom:12}},'ðŸ¢'),
          React.createElement('p',{style:{fontWeight:600,fontSize:16,margin:0}},'No locations yet'),
          React.createElement('p',{style:{margin:'6px 0 0',fontSize:14}},'Click "+ Add Location" to get started')
        ):React.createElement('div',{style:{display:'grid',gridTemplateColumns:'repeat(auto-fill,minmax(240px,1fr))',gap:16}},
          data.locations.map(loc=>React.createElement(LocationCard,{key:loc.id,loc,onSelect:l=>setNav([l.id]),onEdit:l=>setModal({t:'editLoc',loc:l}),onDelete:delLoc}))
        )
      ),
      !searchRes&&nav.length===1&&curLoc&&React.createElement(BuildingView,{loc:curLoc,onRoom:r=>setNav(p=>[...p,r.id]),onAddRoom:()=>setModal({t:'addRoom'}),onEditRoom:r=>setModal({t:'editRoom',room:r}),onDelRoom:delRoom}),
      !searchRes&&nav.length===2&&curRoom&&React.createElement(RoomView,{room:curRoom,onShelf:s=>setNav(p=>[...p,s.id]),onAddShelf:()=>setModal({t:'addShelf'}),onEditShelf:s=>setModal({t:'editShelf',shelf:s}),onDelShelf:delShelf}),
      !searchRes&&nav.length===3&&curShelf&&React.createElement(ShelfView,{shelf:curShelf,onUpdate:updateShelf})
    ),
    modal?.t==='addLoc'&&React.createElement(Modal,{title:'Add Location',onClose:()=>setModal(null)},React.createElement(SimpleForm,{label:'Location',onSave:(n)=>addLoc(n),onClose:()=>setModal(null)})),
    modal?.t==='editLoc'&&React.createElement(Modal,{title:'Edit Location',onClose:()=>setModal(null)},React.createElement(SimpleForm,{label:'Location',initial:modal.loc.name,onSave:n=>editLoc(modal.loc.id,n),onClose:()=>setModal(null)})),
    modal?.t==='addRoom'&&React.createElement(Modal,{title:'Add Room',onClose:()=>setModal(null)},React.createElement(SimpleForm,{label:'Room',onSave:addRoom,onClose:()=>setModal(null)})),
    modal?.t==='editRoom'&&React.createElement(Modal,{title:'Edit Room',onClose:()=>setModal(null)},React.createElement(SimpleForm,{label:'Room',initial:modal.room.name,onSave:n=>editRoom(modal.room.id,n),onClose:()=>setModal(null)})),
    modal?.t==='addShelf'&&React.createElement(Modal,{title:'Add Shelf',onClose:()=>setModal(null)},React.createElement(SimpleForm,{label:'Shelf',onSave:addShelf,onClose:()=>setModal(null)})),
    modal?.t==='editShelf'&&React.createElement(Modal,{title:'Edit Shelf',onClose:()=>setModal(null)},React.createElement(SimpleForm,{label:'Shelf',initial:modal.shelf.name,onSave:n=>editShelf(modal.shelf.id,n),onClose:()=>setModal(null)}))
  );
}
ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(App));
</script>
</body>
</html>
